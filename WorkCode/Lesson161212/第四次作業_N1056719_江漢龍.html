﻿<html>

<head>
    <meta charset="utf-8">
    <title>第四題作業</title>
    <style>
        #container {
            outline: 1px solid red;
            width: 400px;
            height: 400px;
            margin: 50px auto 0 auto;
            position: relative;
            overflow: hidden;
        }
               
        #box {
            border-width: 1px;
            border-style: solid;
            border-color: black;
            padding: 5px;
            background-color: gray;
            position: relative;
        }
    </style>
    <script>
    // 設定條件值，最大高度與最大寬度
    var maxHeight = 400 ;
    var maxWidth  = 400 ;
    // 記錄累計值的計數器，初始預設值
    var boxWidth = 1 ;
    var boxHeight = 1 ;
    var milliseconds=1 ;
    var step = 1 ;
    // 記錄目前移動的位置
    // 1：由「右上」至「左上」
    // 2：由「右上」至「右下」
    // 3：由「右下」至「左下」
    // 4：由「左下」至「左上」
    var indicate = 1 ;
    // 記錄 Interval 物件
    var intervalMove ;
    var intervalCut ;
    // 記錄延遲值
    var delayMilliseconds = 0 ;
    var isRun = 1 ;
    // 取得畫面條件，進行動畫設定
    function start()
    {
        // 外框高度
        var heightInput = document.getElementById("height-input") ;
        maxHeight = parseInt(heightInput.value) ;
        // 外框寬度
        var widthInput = document.getElementById("width-input") ;
        maxWidth = parseInt(widthInput.value) ;
        // 延遲時間
        var milliseconds=document.getElementById("delay-input")
        delayMilliseconds = parseInt(milliseconds.value) ;
        // 外框物件
        var container = document.getElementById("container") ;
        // 設定外框高度與寬度
        container.style.height = parseInt(heightInput.value) ;
        container.style.width = parseInt(widthInput.value) ;
        // 步進值
        var stepInput = document.getElementById("step-input") ;
        step = parseInt(stepInput.value) ;
        if (isRun == 1)
        {
            // 啟動
            setTimeout(moveBox, delayMilliseconds);
            intervalMove = setInterval(moveBox,30) ;
            isRun = 2 ;
        }
    }

    // 動畫效果呈現
    function moveBox()
    {
        var box = document.getElementById("box") ;
        if (indicate == 1)
        {
            // 從左上角開始，left 遞減，高度固定，寬度遞增
            box.style.top = "0px" ;
            box.style.left = "0px" ;
            box.style.height = maxHeight / 2 + "px";

            if (parseInt(boxWidth) > maxWidth)
            {
                // 寬度已經達到最大限度
                // 預設初始值
                boxWidth = 1 ;
                boxHeight = 1 ;
                // 停止執行
                clearInterval(intervalMove);
                // 啟動
                intervalCut = setInterval(cutBox,delayMilliseconds) ;
            }
            else
            {
                boxWidth = boxWidth + step ;
            }            
            // 設定寬度
            box.style.width = parseInt(boxWidth) + "px"  ;
        }
        else if (indicate == 2)
        {
            // 從右上角開始，寬度固定，高度逐漸增加
            box.style.top = "0px" ;
            box.style.left = maxWidth / 2 + "px" ;
            box.style.width = maxWidth / 2 + "px" ;
            if (parseInt(boxHeight) > maxHeight)
            {
                // 高度已經達到最大限度
                // 進行位置變換，並預設初始值
                boxWidth = 1 ;
                boxHeight = 1 ;
                // 停止執行
                clearInterval(intervalMove);
                // 啟動
                intervalCut = setInterval(cutBox,delayMilliseconds) ;
            }
            else
            {
                boxHeight = boxHeight + step ;
            }
            // 設定高度            
            box.style.height = parseInt(boxHeight) + "px"  ;
        }
        else if (indicate == 3)
        {
            var left = maxWidth - parseInt(boxWidth) ;
            if (left < 0)
                left = 0 ;
            // 從右下角開始，left 遞減，高度固定，寬度遞增
            box.style.left = "0px" ;
            box.style.height = maxHeight / 2 + "px";
            if (parseInt(boxWidth) > maxWidth)
            {
                // 寬度已經達到最大限度
                // 進行位置變換，並預設初始值
                boxWidth = 1 ;
                boxHeight = 1 ;
                // 停止執行
                clearInterval(intervalMove);
                // 啟動
                intervalCut = setInterval(cutBox,delayMilliseconds) ;
            }
            else
            {
                boxWidth = boxWidth + step ;
            }
            // 設定畫面左邊位置
            // 設定寬度            
            box.style.left = parseInt(left) + "px"  ;
            box.style.width = parseInt(boxWidth) + "px"  ;
        }
        else if (indicate == 4)
        {
            // 從左下角開始，top 遞減，高度遞增，寬度固定
            var top = maxHeight - parseInt(boxHeight) ;
            if (top < 0)
                top = 0 ;
            box.style.left = "0px" ;
            box.style.width = maxWidth / 2 + "px" ;
            
            if (parseInt(boxHeight) > maxHeight)
            {
                // 高度已經達到最大限度
                // 進行位置變換，並預設初始值
                boxWidth = 1 ;
                boxHeight = 1 ;
                // 停止執行
                clearInterval(intervalMove);
                // 啟動
                intervalCut = setInterval(cutBox,delayMilliseconds) ;
            }
            else
            {
                boxHeight = boxHeight + step ;
            }            
            // 設定畫面上邊位置
            // 設定高度            
            box.style.top = parseInt(top) + "px"  ;
            box.style.height = parseInt(boxHeight) + "px"  ;
        }
        else if (indicate > 4)
        {
            // 回歸初始
            indicate = 1 ;
            // 取得 UI step-input，決定增加或減少
            // 外框高度
            var heightInput = document.getElementById("height-input") ;
            // 外框寬度
            var widthInput = document.getElementById("width-input") ;
            // step-input
            // var stepInput = document.getElementById("step-input") ;
            // step = parseInt(stepInput.value) ;
            //var height = parseInt(heightInput.value) + parseInt(stepInput.value) ;
            //var width =  parseInt(widthInput.value) + parseInt(stepInput.value) ;
            // 設定外框高度與寬度
            container.style.height = height  ;
            container.style.width = width ;            
        }        
    }
    
    function cutBox()
    {
        var box = document.getElementById("box") ;
        if (indicate == 1)
        {
            // 從左上角開始，left 遞增，高度固定，寬度遞減
            var width = maxWidth - parseInt(boxWidth) ;
            if (width <= 1)
                width = 1 ;

            if (parseInt(boxWidth) >= (maxWidth/2))
            {
                // 寬度已經達到最大限度
                // 進行位置變換，並預設初始值
                boxWidth = boxWidth ;
                boxHeight = (maxHeight/2) ;
                indicate ++ ;
                // 停止執行
                clearInterval(intervalCut);
                // 啟動
                intervalMove = setInterval(moveBox,delayMilliseconds) ;
            }
            else
            {
                boxWidth = boxWidth + step ;
                // 設定寬度與左邊位置
                box.style.left = parseInt(boxWidth) + "px"  ;
                box.style.width = parseInt(width) + "px"  ;
            }            
        }
        else if (indicate == 2)
        {
            /*
              從右上角開始，top 遞增，高度遞減，寬度固定
            */
            var hight = maxHeight - parseInt(boxHeight) ;
            if (hight <= 1)
                hight = 1 ;
            if (parseInt(boxHeight) >= (maxHeight / 2))
            {
                // 寬度已經達到最大限度
                // 進行位置變換，並預設初始值
                boxWidth = parseInt(maxWidth)/2 ;
                boxHeight = boxHeight ;
                indicate ++ ;
                // 停止執行
                clearInterval(intervalCut);
                // 啟動
                intervalMove = setInterval(moveBox,delayMilliseconds) ;
            }
            else
            {
                boxHeight = boxHeight + step ;
                // 設定高度
                box.style.top = parseInt(boxHeight) + "px"  ;
                box.style.height = parseInt(hight) + "px"  ;
            }          
        
        }
        else if (indicate == 3)
        {
            /*
              從右下角開始，left 固定，寬度遞減，高度固定
            */
            var width = maxWidth - parseInt(boxWidth) ;
            if (width <= 1)
                width = 1 ;
            if (parseInt(boxWidth) >= (maxWidth / 2))
            {
                // 寬度已經達到最大限度
                // 進行位置變換，並預設初始值
                boxWidth = boxWidth ;
                boxHeight = (maxHeight / 2) ;
                indicate ++ ;
                // 停止執行
                clearInterval(intervalCut);
                // 啟動
                intervalMove = setInterval(moveBox,delayMilliseconds) ;
            }
            else
            {
                boxWidth = boxWidth + step ;
                // 設定寬度
                box.style.width = parseInt(width) + "px"  ;
            }
        }
        else if (indicate == 4)
        {
            /*
              從左下角開始，left 固定，寬度固定，高度遞減
            */
            var height = maxHeight - parseInt(boxHeight) ;
            if (height <= 1)
                height = 1 ;
            if (parseInt(boxHeight) >= (maxHeight / 2))
            {
                // 寬度已經達到最大限度
                // 進行位置變換，並預設初始值
                boxWidth = (maxWidth / 2) ;
                boxHeight = boxHeight ;
                indicate ++ ;
                // 停止執行
                clearInterval(intervalCut);
                // 啟動
                intervalMove = setInterval(moveBox,delayMilliseconds) ;
            }
            else
            {
                boxHeight = boxHeight + step ;
                // 設定高度
                box.style.height = parseInt(height) + "px"  ;
            }
        }
    }
  </script>
</head>

<body onload="start()">
    <div id="input-div">
        高度:<input id="height-input" type="text" onblur="start()" value="400"> 寬度:
        <input id="width-input" type="text" onblur="start()" value="400"> delay:
        <input id="delay-input" type="text" onblur="start()" value="10"> step:
        <input id="step-input" type="text" onblur="start()" value="1">
    </div>
    <div id="container">
        <div id="box">
        </div>
    </div>
</body>

</html>